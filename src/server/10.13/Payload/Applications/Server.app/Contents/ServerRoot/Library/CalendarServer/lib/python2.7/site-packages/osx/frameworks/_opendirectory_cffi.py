##
# Copyright (c) 2015-2017 Apple Inc. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
##


INCLUDES = """
#include <OpenDirectory/OpenDirectory.h>
"""

EXTRA_LINKS = ["-framework", "OpenDirectory"]

TYPES = """
typedef struct __ODSession *ODSessionRef;
typedef struct __ODNode *ODNodeRef;
typedef struct __ODRecord *ODRecordRef;
typedef struct __ODQuery *ODQueryRef;
typedef uint32_t ODMatchType;
typedef const struct __ODContext *ODContextRef;

typedef CFStringRef ODRecordType;
typedef CFStringRef ODAttributeType;
typedef CFStringRef ODAuthenticationType;

enum {
   kODMatchAny = 0x0001,
   kODMatchEqualTo = 0x2001,
   kODMatchBeginsWith = 0x2002,
   kODMatchEndsWith = 0x2003,
   kODMatchContains = 0x2004,
   kODMatchGreaterThan = 0x2006,
   kODMatchLessThan = 0x2007
   //kODMatchInsensitiveEqualTo = 0x2101,
   //kODMatchInsensitiveBeginsWith = 0x2102,
   //kODMatchInsensitiveEndsWith = 0x2103,
   //kODMatchInsensitiveContains = 0x2104
};

"""

CONSTANTS = """
ODSessionRef kODSessionDefault;

const ODRecordType kODRecordTypeAttributeTypes;
const ODRecordType kODRecordTypeAFPServer;
const ODRecordType kODRecordTypeAliases;
const ODRecordType kODRecordTypeAugments;
const ODRecordType kODRecordTypeAutomount;
const ODRecordType kODRecordTypeAutomountMap;
const ODRecordType kODRecordTypeAutoServerSetup;
const ODRecordType kODRecordTypeBootp;
const ODRecordType kODRecordTypeCertificateAuthorities;
const ODRecordType kODRecordTypeComputerLists;
const ODRecordType kODRecordTypeComputerGroups;
const ODRecordType kODRecordTypeComputers;
const ODRecordType kODRecordTypeConfiguration;
const ODRecordType kODRecordTypeEthernets;
const ODRecordType kODRecordTypeFileMakerServers;
const ODRecordType kODRecordTypeFTPServer;
const ODRecordType kODRecordTypeGroups;
const ODRecordType kODRecordTypeHostServices;
const ODRecordType kODRecordTypeHosts;
const ODRecordType kODRecordTypeLDAPServer;
const ODRecordType kODRecordTypeLocations;
const ODRecordType kODRecordTypeMounts;
const ODRecordType kODRecordTypeNFS;
const ODRecordType kODRecordTypeNetDomains;
const ODRecordType kODRecordTypeNetGroups;
const ODRecordType kODRecordTypeNetworks;
const ODRecordType kODRecordTypePeople;
const ODRecordType kODRecordTypePresetComputers;
const ODRecordType kODRecordTypePresetComputerGroups;
const ODRecordType kODRecordTypePresetComputerLists;
const ODRecordType kODRecordTypePresetGroups;
const ODRecordType kODRecordTypePresetUsers;
const ODRecordType kODRecordTypePrintService;
const ODRecordType kODRecordTypePrintServiceUser;
const ODRecordType kODRecordTypePrinters;
const ODRecordType kODRecordTypeProtocols;
const ODRecordType kODRecordTypeQTSServer;
const ODRecordType kODRecordTypeQueryInformation;
const ODRecordType kODRecordTypeRecordTypes;
const ODRecordType kODRecordTypeResources;
const ODRecordType kODRecordTypeRPC;
const ODRecordType kODRecordTypeSMBServer;
const ODRecordType kODRecordTypeServer;
const ODRecordType kODRecordTypeServices;
const ODRecordType kODRecordTypeSharePoints;
const ODRecordType kODRecordTypeUsers;
const ODRecordType kODRecordTypeWebServer;

const ODAttributeType kODAttributeTypeAllAttributes;
const ODAttributeType kODAttributeTypeStandardOnly;
const ODAttributeType kODAttributeTypeNativeOnly;
const ODAttributeType kODAttributeTypeMetaAmbiguousName;
const ODAttributeType kODAttributeTypeMetaAugmentedAttributes;
const ODAttributeType kODAttributeTypeMetaRecordName;
const ODAttributeType kODAttributeTypeAdminLimits;
const ODAttributeType kODAttributeTypeAltSecurityIdentities;
const ODAttributeType kODAttributeTypeAuthenticationHint;
const ODAttributeType kODAttributeTypeAllTypes;
const ODAttributeType kODAttributeTypeAuthorityRevocationList;
const ODAttributeType kODAttributeTypeBirthday;
const ODAttributeType kODAttributeTypeCACertificate;
const ODAttributeType kODAttributeTypeCapacity;
const ODAttributeType kODAttributeTypeCertificateRevocationList;
const ODAttributeType kODAttributeTypeComment;
const ODAttributeType kODAttributeTypeContactGUID;
const ODAttributeType kODAttributeTypeContactPerson;
const ODAttributeType kODAttributeTypeCreationTimestamp;
const ODAttributeType kODAttributeTypeCrossCertificatePair;
const ODAttributeType kODAttributeTypeDataStamp;
const ODAttributeType kODAttributeTypeFullName;
const ODAttributeType kODAttributeTypeDNSDomain;
const ODAttributeType kODAttributeTypeDNSNameServer;
const ODAttributeType kODAttributeTypeENetAddress;
const ODAttributeType kODAttributeTypeExpire;
const ODAttributeType kODAttributeTypeFirstName;
const ODAttributeType kODAttributeTypeGUID;
const ODAttributeType kODAttributeTypeHardwareUUID;
const ODAttributeType kODAttributeTypeHomeDirectoryQuota;
const ODAttributeType kODAttributeTypeHomeDirectorySoftQuota;
const ODAttributeType kODAttributeTypeHomeLocOwner;
const ODAttributeType kODAttributeTypeInternetAlias;
const ODAttributeType kODAttributeTypeKDCConfigData;
const ODAttributeType kODAttributeTypeKerberosServices;
const ODAttributeType kODAttributeTypeLastName;
const ODAttributeType kODAttributeTypeLDAPSearchBaseSuffix;
const ODAttributeType kODAttributeTypeLocation;
const ODAttributeType kODAttributeTypeMapGUID;
const ODAttributeType kODAttributeTypeMCXFlags;
const ODAttributeType kODAttributeTypeMCXSettings;
const ODAttributeType kODAttributeTypeMailAttribute;
const ODAttributeType kODAttributeTypeMetaAutomountMap;
const ODAttributeType kODAttributeTypeMiddleName;
const ODAttributeType kODAttributeTypeModificationTimestamp;
const ODAttributeType kODAttributeTypeNFSHomeDirectory;
const ODAttributeType kODAttributeTypeNote;
const ODAttributeType kODAttributeTypeOperatingSystem;
const ODAttributeType kODAttributeTypeOperatingSystemVersion;
const ODAttributeType kODAttributeTypeOwner;
const ODAttributeType kODAttributeTypeOwnerGUID;
const ODAttributeType kODAttributeTypePassword;
const ODAttributeType kODAttributeTypePasswordPlus;
const ODAttributeType kODAttributeTypePasswordPolicyOptions;
const ODAttributeType kODAttributeTypePasswordServerList;
const ODAttributeType kODAttributeTypePasswordServerLocation;
const ODAttributeType kODAttributeTypePicture;
const ODAttributeType kODAttributeTypePort;
const ODAttributeType kODAttributeTypePresetUserIsAdmin;
const ODAttributeType kODAttributeTypePrimaryComputerGUID;
const ODAttributeType kODAttributeTypePrimaryComputerList;
const ODAttributeType kODAttributeTypePrimaryGroupID;
const ODAttributeType kODAttributeTypePrinter1284DeviceID;
const ODAttributeType kODAttributeTypePrinterLPRHost;
const ODAttributeType kODAttributeTypePrinterLPRQueue;
const ODAttributeType kODAttributeTypePrinterMakeAndModel;
const ODAttributeType kODAttributeTypePrinterType;
const ODAttributeType kODAttributeTypePrinterURI;
const ODAttributeType kODAttributeTypePrinterXRISupported;
const ODAttributeType kODAttributeTypePrintServiceInfoText;
const ODAttributeType kODAttributeTypePrintServiceInfoXML;
const ODAttributeType kODAttributeTypePrintServiceUserData;
const ODAttributeType kODAttributeTypeRealUserID;
const ODAttributeType kODAttributeTypeRelativeDNPrefix;
const ODAttributeType kODAttributeTypeSMBAcctFlags;
const ODAttributeType kODAttributeTypeSMBGroupRID;
const ODAttributeType kODAttributeTypeSMBHome;
const ODAttributeType kODAttributeTypeSMBHomeDrive;
const ODAttributeType kODAttributeTypeSMBKickoffTime;
const ODAttributeType kODAttributeTypeSMBLogoffTime;
const ODAttributeType kODAttributeTypeSMBLogonTime;
const ODAttributeType kODAttributeTypeSMBPrimaryGroupSID;
const ODAttributeType kODAttributeTypeSMBPWDLastSet;
const ODAttributeType kODAttributeTypeSMBProfilePath;
const ODAttributeType kODAttributeTypeSMBRID;
const ODAttributeType kODAttributeTypeSMBScriptPath;
const ODAttributeType kODAttributeTypeSMBSID;
const ODAttributeType kODAttributeTypeSMBUserWorkstations;
const ODAttributeType kODAttributeTypeServiceType;
const ODAttributeType kODAttributeTypeSetupAdvertising;
const ODAttributeType kODAttributeTypeSetupAutoRegister;
const ODAttributeType kODAttributeTypeSetupLocation;
const ODAttributeType kODAttributeTypeSetupOccupation;
const ODAttributeType kODAttributeTypeTimeToLive;
const ODAttributeType kODAttributeTypeTrustInformation;
const ODAttributeType kODAttributeTypeUniqueID;
const ODAttributeType kODAttributeTypeUserCertificate;
const ODAttributeType kODAttributeTypeUserPKCS12Data;
const ODAttributeType kODAttributeTypeUserShell;
const ODAttributeType kODAttributeTypeUserSMIMECertificate;
const ODAttributeType kODAttributeTypeVFSDumpFreq;
const ODAttributeType kODAttributeTypeVFSLinkDir;
const ODAttributeType kODAttributeTypeVFSPassNo;
const ODAttributeType kODAttributeTypeVFSType;
const ODAttributeType kODAttributeTypeWeblogURI;
const ODAttributeType kODAttributeTypeXMLPlist;
const ODAttributeType kODAttributeTypeProtocolNumber;
const ODAttributeType kODAttributeTypeRPCNumber;
const ODAttributeType kODAttributeTypeNetworkNumber;
const ODAttributeType kODAttributeTypeAccessControlEntry;
const ODAttributeType kODAttributeTypeAddressLine1;
const ODAttributeType kODAttributeTypeAddressLine2;
const ODAttributeType kODAttributeTypeAddressLine3;
const ODAttributeType kODAttributeTypeAreaCode;
const ODAttributeType kODAttributeTypeAuthenticationAuthority;
const ODAttributeType kODAttributeTypeAutomountInformation;
const ODAttributeType kODAttributeTypeBootParams;
const ODAttributeType kODAttributeTypeBuilding;
const ODAttributeType kODAttributeTypeServicesLocator;
const ODAttributeType kODAttributeTypeCity;
const ODAttributeType kODAttributeTypeCompany;
const ODAttributeType kODAttributeTypeComputers;
const ODAttributeType kODAttributeTypeCountry;
const ODAttributeType kODAttributeTypeDepartment;
const ODAttributeType kODAttributeTypeDNSName;
const ODAttributeType kODAttributeTypeEMailAddress;
const ODAttributeType kODAttributeTypeEMailContacts;
const ODAttributeType kODAttributeTypeFaxNumber;
const ODAttributeType kODAttributeTypeGroup;
const ODAttributeType kODAttributeTypeGroupMembers;
const ODAttributeType kODAttributeTypeGroupMembership;
const ODAttributeType kODAttributeTypeGroupServices;
const ODAttributeType kODAttributeTypeHomePhoneNumber;
const ODAttributeType kODAttributeTypeHTML;
const ODAttributeType kODAttributeTypeHomeDirectory;
const ODAttributeType kODAttributeTypeIMHandle;
const ODAttributeType kODAttributeTypeIPAddress;
const ODAttributeType kODAttributeTypeIPAddressAndENetAddress;
const ODAttributeType kODAttributeTypeIPv6Address;
const ODAttributeType kODAttributeTypeJPEGPhoto;
const ODAttributeType kODAttributeTypeJobTitle;
const ODAttributeType kODAttributeTypeKDCAuthKey;
const ODAttributeType kODAttributeTypeKeywords;
const ODAttributeType kODAttributeTypeLDAPReadReplicas;
const ODAttributeType kODAttributeTypeLDAPWriteReplicas;
const ODAttributeType kODAttributeTypeMapCoordinates;
const ODAttributeType kODAttributeTypeMapURI;
const ODAttributeType kODAttributeTypeMIME;
const ODAttributeType kODAttributeTypeMobileNumber;
const ODAttributeType kODAttributeTypeNestedGroups;
const ODAttributeType kODAttributeTypeNetGroups;
const ODAttributeType kODAttributeTypeNickName;
const ODAttributeType kODAttributeTypeOrganizationInfo;
const ODAttributeType kODAttributeTypeOrganizationName;
const ODAttributeType kODAttributeTypePagerNumber;
const ODAttributeType kODAttributeTypePhoneContacts;
const ODAttributeType kODAttributeTypePhoneNumber;
const ODAttributeType kODAttributeTypePGPPublicKey;
const ODAttributeType kODAttributeTypePostalAddress;
const ODAttributeType kODAttributeTypePostalAddressContacts;
const ODAttributeType kODAttributeTypePostalCode;
const ODAttributeType kODAttributeTypeNamePrefix;
const ODAttributeType kODAttributeTypeProfiles;
const ODAttributeType kODAttributeTypeProfilesTimestamp;
const ODAttributeType kODAttributeTypeProtocols;
const ODAttributeType kODAttributeTypeRecordName;
const ODAttributeType kODAttributeTypeRelationships;
const ODAttributeType kODAttributeTypeResourceInfo;
const ODAttributeType kODAttributeTypeResourceType;
const ODAttributeType kODAttributeTypeState;
const ODAttributeType kODAttributeTypeStreet;
const ODAttributeType kODAttributeTypeNameSuffix;
const ODAttributeType kODAttributeTypeURL;
const ODAttributeType kODAttributeTypeVFSOpts;
const ODAttributeType kODAttributeTypeAlias;
const ODAttributeType kODAttributeTypeAuthCredential;
const ODAttributeType kODAttributeTypeCopyTimestamp;
const ODAttributeType kODAttributeTypeDateRecordCreated;
const ODAttributeType kODAttributeTypeKerberosRealm;
const ODAttributeType kODAttributeTypeNTDomainComputerAccount;
const ODAttributeType kODAttributeTypeOriginalHomeDirectory;
const ODAttributeType kODAttributeTypeOriginalNFSHomeDirectory;
const ODAttributeType kODAttributeTypeOriginalNodeName;
const ODAttributeType kODAttributeTypePrimaryNTDomain;
const ODAttributeType kODAttributeTypePwdAgingPolicy;
const ODAttributeType kODAttributeTypeReadOnlyNode;
const ODAttributeType kODAttributeTypeTimePackage;
const ODAttributeType kODAttributeTypeTotalSize;
const ODAttributeType kODAttributeTypeAuthMethod;
const ODAttributeType kODAttributeTypeMetaNodeLocation;
const ODAttributeType kODAttributeTypeNodePath;
const ODAttributeType kODAttributeTypePlugInInfo;
const ODAttributeType kODAttributeTypeRecordType;
const ODAttributeType kODAttributeTypeSchema;
const ODAttributeType kODAttributeTypeSubNodes;
const ODAttributeType kODAttributeTypeNetGroupTriplet;
const ODAttributeType kODAttributeTypeSearchPath;
const ODAttributeType kODAttributeTypeSearchPolicy;
const ODAttributeType kODAttributeTypeAutomaticSearchPath;
const ODAttributeType kODAttributeTypeLocalOnlySearchPath;
const ODAttributeType kODAttributeTypeCustomSearchPath;
const ODAttributeType kODAttributeTypeNodeOptions;
//const ODAttributeType kODAttributeTypeNodeSASLRealm;
const ODAttributeType kODAttributeTypeAdvertisedServices;
const ODAttributeType kODAttributeTypeLocaleRelay;
const ODAttributeType kODAttributeTypeLocaleSubnets;
const ODAttributeType kODAttributeTypeNetworkInterfaces;
const ODAttributeType kODAttributeTypeParentLocales;
const ODAttributeType kODAttributeTypePrimaryLocale;
const ODAttributeType kODAttributeTypeBuildVersion;
const ODAttributeType kODAttributeTypeConfigAvailable;
const ODAttributeType kODAttributeTypeConfigFile;
const ODAttributeType kODAttributeTypeCoreFWVersion;
const ODAttributeType kODAttributeTypeFunctionalState;
const ODAttributeType kODAttributeTypeFWVersion;
const ODAttributeType kODAttributeTypePluginIndex;
const ODAttributeType kODAttributeTypeNumTableList;
const ODAttributeType kODAttributeTypeVersion;
const ODAttributeType kODAttributeTypePIDValue;
const ODAttributeType kODAttributeTypeProcessName;
const ODAttributeType kODAttributeTypeTotalRefCount;
const ODAttributeType kODAttributeTypeDirRefCount;
const ODAttributeType kODAttributeTypeNodeRefCount;
const ODAttributeType kODAttributeTypeRecRefCount;
const ODAttributeType kODAttributeTypeAttrListRefCount;
const ODAttributeType kODAttributeTypeAttrListValueRefCount;
const ODAttributeType kODAttributeTypeDirRefs;
const ODAttributeType kODAttributeTypeNodeRefs;
const ODAttributeType kODAttributeTypeRecRefs;
const ODAttributeType kODAttributeTypeAttrListRefs;
const ODAttributeType kODAttributeTypeAttrListValueRefs;

const ODAuthenticationType kODAuthenticationType2WayRandom;
const ODAuthenticationType kODAuthenticationType2WayRandomChangePasswd;
const ODAuthenticationType kODAuthenticationTypeAPOP;
const ODAuthenticationType kODAuthenticationTypeCRAM_MD5;
const ODAuthenticationType kODAuthenticationTypeChangePasswd;
const ODAuthenticationType kODAuthenticationTypeClearText;
const ODAuthenticationType kODAuthenticationTypeCrypt;
const ODAuthenticationType kODAuthenticationTypeDIGEST_MD5;
const ODAuthenticationType kODAuthenticationTypeDeleteUser;
const ODAuthenticationType kODAuthenticationTypeGetEffectivePolicy;
const ODAuthenticationType kODAuthenticationTypeGetGlobalPolicy;
const ODAuthenticationType kODAuthenticationTypeGetKerberosPrincipal;
const ODAuthenticationType kODAuthenticationTypeGetPolicy;
const ODAuthenticationType kODAuthenticationTypeGetUserData;
const ODAuthenticationType kODAuthenticationTypeGetUserName;
const ODAuthenticationType kODAuthenticationTypeKerberosTickets;
const ODAuthenticationType kODAuthenticationTypeMPPEMasterKeys;
const ODAuthenticationType kODAuthenticationTypeMSCHAP2;
const ODAuthenticationType kODAuthenticationTypeNTLMv2;
const ODAuthenticationType kODAuthenticationTypeNTLMv2WithSessionKey;
const ODAuthenticationType kODAuthenticationTypeNewUser;
const ODAuthenticationType kODAuthenticationTypeNewUserWithPolicy;
const ODAuthenticationType kODAuthenticationTypeNodeNativeClearTextOK;
const ODAuthenticationType kODAuthenticationTypeNodeNativeNoClearText;
const ODAuthenticationType kODAuthenticationTypeReadSecureHash;
const ODAuthenticationType kODAuthenticationTypeSMBNTv2UserSessionKey;
const ODAuthenticationType kODAuthenticationTypeSMBWorkstationCredentialSessionKey;
const ODAuthenticationType kODAuthenticationTypeSMB_LM_Key;
const ODAuthenticationType kODAuthenticationTypeSMB_NT_Key;
const ODAuthenticationType kODAuthenticationTypeSMB_NT_UserSessionKey;
const ODAuthenticationType kODAuthenticationTypeSMB_NT_WithUserSessionKey;
const ODAuthenticationType kODAuthenticationTypeSetGlobalPolicy;
const ODAuthenticationType kODAuthenticationTypeSetLMHash;
const ODAuthenticationType kODAuthenticationTypeSetNTHash;
const ODAuthenticationType kODAuthenticationTypeSetPassword;
const ODAuthenticationType kODAuthenticationTypeSetPasswordAsCurrent;
const ODAuthenticationType kODAuthenticationTypeSetPolicy;
const ODAuthenticationType kODAuthenticationTypeSetPolicyAsCurrent;
const ODAuthenticationType kODAuthenticationTypeSetUserData;
const ODAuthenticationType kODAuthenticationTypeSetUserName;
const ODAuthenticationType kODAuthenticationTypeSetWorkstationPassword;
const ODAuthenticationType kODAuthenticationTypeWithAuthorizationRef;
const ODAuthenticationType kODAuthenticationTypeWriteSecureHash;"""

FUNCTIONS = """
ODSessionRef ODSessionCreate ( CFAllocatorRef allocator, CFDictionaryRef options, CFErrorRef *error );
CFArrayRef ODSessionCopyNodeNames ( CFAllocatorRef allocator, ODSessionRef session, CFErrorRef *error );

ODNodeRef ODNodeCreateWithName ( CFAllocatorRef allocator, ODSessionRef session, CFStringRef nodeName, CFErrorRef *error );
bool ODNodeSetCredentials ( ODNodeRef node, ODRecordType recordType, CFStringRef recordName, CFStringRef password, CFErrorRef *error );
CFDictionaryRef ODNodeCopyDetails ( ODNodeRef node, CFArrayRef keys, CFErrorRef *error );
ODRecordRef ODNodeCopyRecord ( ODNodeRef node, ODRecordType recordType, CFStringRef recordName, CFTypeRef attributes, CFErrorRef *error );

CFDictionaryRef ODRecordCopyDetails ( ODRecordRef record, CFArrayRef attributes, CFErrorRef *error );
bool ODRecordVerifyPassword ( ODRecordRef record, CFStringRef password, CFErrorRef *error );
bool ODRecordVerifyPasswordExtended ( ODRecordRef record, ODAuthenticationType authType, CFArrayRef authItems, CFArrayRef *outAuthItems, ODContextRef *outContext, CFErrorRef *error );

CFArrayRef ODQueryCopyResults ( ODQueryRef query, bool allowPartialResults, CFErrorRef *error );
ODQueryRef ODQueryCreateWithNode ( CFAllocatorRef allocator, ODNodeRef node, CFTypeRef recordTypeOrList, ODAttributeType attribute, ODMatchType matchType, CFTypeRef queryValueOrList, CFTypeRef returnAttributeOrList, CFIndex maxResults, CFErrorRef *error );
"""
